# ═══════════════════════════════════════════════════════════════════════════════
#                    IQRA-12 Agents Layer
#                        طبقة الوكلاء
# ═══════════════════════════════════════════════════════════════════════════════

## المبدأ المركزي

> **"الوكيل ليس LLM، بل نظام تشغيل يدير LLM"**
> — Zhiheng Xi

---

## المعمارية

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         طبقة الوكلاء                                    │
│                   "العقول الرقمية لإقرأ-12"                             │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
          ┌─────────────────────────┼─────────────────────────┐
          │                         │                         │
          ▼                         ▼                         ▼
    ┌───────────────┐       ┌───────────────┐       ┌───────────────┐
    │  الوكيل الفردي │       │ سلم الاستقلالية│       │  عقود الوكلاء │
    │ Brain-Percept │       │   L0 → L4     │       │  Agent Cards  │
    │ -Action       │       │               │       │               │
    └───────────────┘       └───────────────┘       └───────────────┘
          │                         │                         │
          └─────────────────────────┼─────────────────────────┘
                                    │
                                    ▼
                      ┌───────────────────────┐
                      │     المنسق الرئيسي   │
                      │      Orchestrator     │
                      └───────────────────────┘
                                    │
          ┌─────────────────────────┼─────────────────────────┐
          │                         │                         │
          ▼                         ▼                         ▼
    ┌───────────────┐       ┌───────────────┐       ┌───────────────┐
    │  سجل الوكلاء  │       │  إطار التقييم │       │  سجل القرارات │
    │   Registry    │       │    Evals      │       │ Decision Log  │
    └───────────────┘       └───────────────┘       └───────────────┘
```

---

## هيكل الملفات

```
iqra12_agents_layer/
│
├── README.md                              # هذا الملف
├── 00_LAYER_OVERVIEW.yaml                 # نظرة عامة + الآباء المؤسسون
│
├── 01_single_agent_architecture.yaml      # معمارية الوكيل الفردي
│   ├── Brain-Perception-Action Framework
│   ├── ReAct Protocol
│   ├── Generative Memory
│   └── Self-Correction (Reflexion)
│
├── 02_autonomy_ladder.yaml                # سلم الاستقلالية
│   ├── 5 مستويات (L0 → L4)
│   ├── قواعد الترقية والتخفيض
│   └── مصفوفة الصلاحيات
│
├── 03_agent_contracts_registry.yaml       # عقود الوكلاء وسجلهم
│   ├── Agent Card Schema
│   ├── Input/Output Contracts
│   └── سجل الوكلاء (أمثلة)
│
├── 04_multi_agent_orchestration.yaml      # تنسيق متعدد الوكلاء
│   ├── أنماط التنسيق (4 أنماط)
│   ├── بروتوكول الرسائل
│   └── فرق العمل المعيارية
│
└── 05_evaluation_framework.yaml           # إطار التقييم
    ├── أنواع التقييم (5 أنواع)
    ├── CheckList methodology
    ├── كشف الانحراف
    └── دورة التقييم
```

---

## الآباء المؤسسون

### معمارية الوكيل الفردي

| الرائد | المجال | الدرس الأساسي |
|--------|--------|---------------|
| **Zhiheng Xi** | Agentic AI | Brain-Perception-Action Framework |
| **Shunyu Yao** | ReAct | فكّر → تصرّف → لاحظ |
| **Joon Sung Park** | Generative Agents | الذاكرة التوليدية |
| **Toolformer Team** | Tool Use | الوكيل يتعلم استخدام الأدوات |
| **Noah Shinn** | Reflexion | التصحيح الذاتي |

### الأنظمة متعددة الوكلاء

| الرائد | المجال | الدرس الأساسي |
|--------|--------|---------------|
| **AutoGen Team** | Multi-Agent | الحوار المنظم بين الوكلاء |
| **Victor Lesser** | Distributed AI | السبورة المشتركة |
| **Michael Wooldridge** | BDI Model | معتقد-رغبة-نية |
| **Yoav Shoham** | ACL | لغة تواصل مهيكلة |
| **Barbara Grosz** | SharedPlans | الخطط المشتركة |

### التحكم والتقييم

| الرائد | المجال | الدرس الأساسي |
|--------|--------|---------------|
| **Ben Shneiderman** | HCAI | الجمع بين الأتمتة والتحكم |
| **Timnit Gebru** | Accountability | التوثيق شرط للمساءلة |
| **Don Norman** | Error Prevention | منع الخطأ قبل وقوعه |
| **Marco Ribeiro** | CheckList | الاختبار السلوكي المنهجي |
| **Percy Liang** | HELM | التقييم الشمولي |

---

## سلم الاستقلالية

```
┌─────────────────────────────────────────────────────────────────────────┐
│ L4 │ طيار محدود    │ أعمال إدارية فقط                    │ 🔴 Red     │
├─────────────────────────────────────────────────────────────────────────┤
│ L3 │ تنفيذ مشروط   │ تنفيذ تلقائي ضمن شروط صارمة         │ 🟣 Purple  │
├─────────────────────────────────────────────────────────────────────────┤
│ L2 │ تنفيذ مراقب   │ تنفيذ بعد موافقة بشرية              │ 🟠 Orange  │
├─────────────────────────────────────────────────────────────────────────┤
│ L1 │ اقتراح        │ يقترح دون تنفيذ                      │ 🔵 Blue    │
├─────────────────────────────────────────────────────────────────────────┤
│ L0 │ قراءة فقط     │ يستعلم ويعرض فقط                     │ 🟢 Green   │
└─────────────────────────────────────────────────────────────────────────┘

القاعدة الذهبية: كلما زادت خطورة القرار، قلّت استقلالية الوكيل
```

---

## أنماط التنسيق

| النمط | الوصف | الاستخدام |
|-------|-------|-----------|
| **خطي** | مهام متسلسلة | معالجة المخطوطات |
| **جدلي** | مؤيد + معارض | اعتماد الادعاءات |
| **هرمي** | منسق + عمال | البحث المعقد |
| **تشاركي** | وكلاء متساوون | المراجعة المتعددة |

---

## بروتوكول ReAct

```
┌────────────────────────────────────────────────────────────────┐
│                    حلقة ReAct                                  │
└────────────────────────────────────────────────────────────────┘
                          │
                          ▼
              ┌───────────────────┐
              │     Thought       │  ← تحليل الطلب
              │      التفكير      │
              └─────────┬─────────┘
                        │
                        ▼
              ┌───────────────────┐
              │     Action        │  ← استدعاء أداة
              │      الفعل        │
              └─────────┬─────────┘
                        │
                        ▼
              ┌───────────────────┐
              │   Observation     │  ← استقبال النتيجة
              │    الملاحظة      │
              └─────────┬─────────┘
                        │
                        ▼
              ┌───────────────────┐
              │    Continue?      │
              │   هل نستمر؟      │
              └─────────┬─────────┘
                   نعم ↓   ↓ لا
                   ┌───┘   └───────────────┐
                   ↓                       ▼
            [العودة للتفكير]        [الإجابة النهائية]
```

---

## فئات الوكلاء

| الفئة | الوكلاء | الاستقلالية النموذجية |
|-------|---------|----------------------|
| **البحث** | Recipe Builder, Evidence Hunter, Counter-Evidence Seeker | L1-L2 |
| **الربط** | Entity Extractor, Identity Resolver, Relation Proposer | L1-L2 |
| **الاستنتاج** | Claim Drafter, Scope Setter, Uncertainty Assessor | L1-L2 |
| **الكتابة** | Outline Builder, Section Writer, Citation Auditor | L1-L2 |
| **الحوكمة** | Rights Checker, Quality Auditor, Cost Monitor | L2-L4 |
| **الفجوات** | Gap Hunter, Blind Spot Detector | L1-L2 |

---

## إطار التقييم (CheckList)

| نوع الاختبار | الرمز | الوصف |
|--------------|-------|-------|
| **الحد الأدنى** | MFT | اختبار قدرة أساسية واحدة |
| **الثبات** | INV | تغييرات لا تؤثر على النتيجة |
| **الاتجاه** | DIR | تغييرات تؤثر بطريقة متوقعة |
| **الحدود** | EDGE | حالات حدية |
| **العدائية** | ADV | محاولات اختراق |
| **القيم** | VALUE | الالتزام بالقيم |

---

## القواعد الذهبية

### من Zhiheng Xi:
> "الوكيل = دماغ (LLM) + إدراك (محولات) + فعل (أدوات)"

### من Shunyu Yao:
> "ممنوع الإجابة المباشرة للمهام المعقدة"

### من Ben Shneiderman:
> "الاستقلالية ليست ميزة، بل سياسة"

### من Timnit Gebru:
> "عدم اكتمال بطاقة الوكيل = خفض الاستقلالية تلقائياً"

### من Don Norman:
> "النظام يمنع الفعل المؤذي قبل وقوعه"

---

## الإحصائيات

```
المكونات:              5 ملفات YAML + README
الآباء المؤسسون:       15+ رائد
مستويات الاستقلالية:  5 مستويات
أنماط التنسيق:        4 أنماط
فئات الوكلاء:         6 فئات
الوكلاء المعرّفون:    18+ وكيل
أنواع التقييم:        6 أنواع
```

---

## العلاقة مع الطبقات الأخرى

```
┌─────────────────────────────────────────────────────────────────┐
│                    طبقة العمليات (44 عملية)                    │
│                 iqra12_operations_contracts                      │
└─────────────────────────────────────────────────────────────────┘
                              ▲
                              │ تنفذ
                              │
┌─────────────────────────────────────────────────────────────────┐
│                    طبقة الوكلاء (هذه الحزمة)                    │
│                    iqra12_agents_layer                           │
└─────────────────────────────────────────────────────────────────┘
                              ▲
                              │ تستخدم
                              │
┌─────────────────────────────────────────────────────────────────┐
│                    طبقة المعرفة                                  │
│                 iqra12_knowledge_layer                           │
└─────────────────────────────────────────────────────────────────┘
```

---

**إقرأ-12** | طبقة الوكلاء | 2024
